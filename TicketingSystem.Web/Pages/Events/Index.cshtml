@page
@model TicketingSystem.Web.Pages.Events.IndexModel
@{
    ViewData["Title"] = "Events";
}

<div class="page-header">
    <h1>Browse Events</h1>
    <form method="get" class="filters">
        <input type="text" name="searchTerm" value="@Model.SearchTerm" class="form-control" placeholder="Search events...">
        <button type="submit" class="btn btn-primary ms-2">Search</button>
    </form>
</div>

<div class="row mt-4">
    @if (Model.Events.Any())
    {
        @foreach (var item in Model.Events)
        {
            <div class="col-md-4 mb-4">
                <div class="card event-listing">
                    <div class="status-indicator"></div>
                    @if (!string.IsNullOrEmpty(item.ImageUrl))
                    {
                        <img src="@item.ImageUrl" class="card-img-top" alt="@item.Title" />
                    }
                    else
                    {
                        <div class="card-img-top event-placeholder">
                            <span>X</span>
                        </div>
                    }
                    <div class="card-body">
                        <h5 class="card-title">@item.Title</h5>
                        <p class="card-text"><strong>Date:</strong> @item.Date.ToString("MMMM d, yyyy")</p>
                        <p class="card-text"><strong>Location:</strong> @item.Location</p>
                        <p class="card-text text-truncate">@item.Description</p>
                        <p class="card-text">
                            <strong>Price:</strong> 
                            @if (item.TicketPrice == 0)
                            {
                                <span>Free</span>
                            }
                            else
                            {
                                <span>$@item.TicketPrice.ToString("F2")</span>
                            }
                        </p>
                        <p class="card-text">
                            <strong>Seats:</strong> @item.AvailableSeatCount / @item.Capacity
                        </p>
                        <div class="d-flex justify-content-between align-items-center">
                            @if (item.Status == "Available")
                            {
                                <span class="badge bg-dark">Available</span>
                                <a asp-page="/Events/Details" asp-route-id="@item.Id" class="btn btn-primary">View Details</a>
                            }
                            else if (item.Status == "Limited")
                            {
                                <span class="badge bg-secondary">Limited</span>
                                <a asp-page="/Events/Details" asp-route-id="@item.Id" class="btn btn-primary">View Details</a>
                            }
                            else if (item.Status == "Sold Out")
                            {
                                <span class="badge bg-light text-dark border">Sold Out</span>
                                <a href="#" class="btn btn-outline-dark">Join Waitlist</a>
                            }
                            else if (item.Status == "Cancelled")
                            {
                                <span class="badge bg-danger">Cancelled</span>
                                <a asp-page="/Events/Details" asp-route-id="@item.Id" class="btn btn-outline-secondary">View Details</a>
                            }
                            else if (item.Status == "Completed")
                            {
                                <span class="badge bg-info">Completed</span>
                                <a asp-page="/Events/Details" asp-route-id="@item.Id" class="btn btn-outline-secondary">View Details</a>
                            }
                        </div>
                    </div>
                </div>
            </div>
        }
    }
    else
    {
        <div class="col-12">
            <div class="alert alert-info">
                No events found. @if (!string.IsNullOrEmpty(Model.SearchTerm)) { <span>Try a different search term.</span> }
            </div>
            @if (!string.IsNullOrEmpty(Model.DebugInfo))
            {
                <div class="alert alert-warning mt-3">
                    <h5>Debug Info:</h5>
                    <p>@Model.DebugInfo</p>
                </div>
            }
        </div>
    }
</div>

<style>
    .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid #e9ecef;
    }
    
    .page-header h1 {
        font-size: 1.75rem;
        font-weight: 700;
        margin: 0;
        color: #212121;
    }
    
    .filters {
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }
    
    .filters .form-control {
        border-radius: 8px;
        border: 1px solid #ced4da;
        padding: 0.5rem 0.75rem;
        font-size: 0.875rem;
        min-width: 250px;
    }

    .filters .btn {
        padding: 0.5rem 1rem;
        font-size: 0.875rem;
        border-radius: 8px;
    }
    
    .event-listing {
        position: relative;
        overflow: hidden;
        transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        border: 1px solid #e9ecef;
        border-radius: 12px;
        background: white;
        margin-bottom: 1.5rem;
    }
    
    .event-listing::after {
        content: '';
        position: absolute;
        top: 4px;
        right: -4px;
        bottom: -4px;
        left: 4px;
        background-color: rgba(0,0,0,0.03);
        z-index: -1;
        border-radius: 12px;
    }
    
    .event-listing:hover {
        transform: translateY(-8px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.12);
    }
    
    .status-indicator {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background-color: #212121;
        border-radius: 12px 12px 0 0;
    }
    
    .card-body {
        padding: 1.25rem;
    }

    .card-title {
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 0.75rem;
        color: #212121;
    }

    .card-text {
        font-size: 0.875rem;
        margin-bottom: 0.5rem;
        color: #495057;
        line-height: 1.4;
    }

    .card-text strong {
        color: #212121;
        font-weight: 600;
    }
    
    .badge {
        font-size: 0.75rem;
        padding: 0.35em 0.65em;
        border-radius: 6px;
        font-weight: 500;
    }

    .badge.bg-dark {
        background-color: #212121 !important;
    }

    .badge.bg-secondary {
        background-color: #6c757d !important;
    }

    .badge.bg-light {
        background-color: #f8f9fa !important;
        color: #212121 !important;
        border: 1px solid #dee2e6;
    }
    
    .btn {
        font-size: 0.875rem;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        font-weight: 500;
        transition: all 0.2s ease;
    }

    .btn-primary {
        background-color: #212121;
        border-color: #212121;
    }

    .btn-primary:hover {
        background-color: #000;
        border-color: #000;
        transform: translateY(-1px);
    }

    .btn-outline-dark {
        border: 1px solid #212121;
        color: #212121;
    }

    .btn-outline-dark:hover {
        background-color: #212121;
        border-color: #212121;
        color: white;
        transform: translateY(-1px);
    }

    .btn-outline-secondary {
        border: 1px solid #6c757d;
        color: #6c757d;
    }

    .btn-outline-secondary:hover {
        background-color: #6c757d;
        border-color: #6c757d;
        color: white;
        transform: translateY(-1px);
    }
    
    .card-img-top {
        height: 180px;
        object-fit: cover;
        border-radius: 12px 12px 0 0;
    }

    .d-flex.justify-content-between.align-items-center {
        margin-top: 1rem;
        padding-top: 0.75rem;
        border-top: 1px solid #f1f3f4;
    }

    .alert {
        border-radius: 8px;
        border: none;
        font-size: 0.875rem;
        padding: 1rem 1.25rem;
    }

    .alert-info {
        background-color: #e7f3ff;
        color: #0c5460;
    }

    .alert-warning {
        background-color: #fff3cd;
        color: #856404;
    }

    /* Grid layout for better spacing */
    .row.mt-4 {
        margin-top: 2rem !important;
    }

    .col-md-4 {
        margin-bottom: 2rem;
    }
</style> 